<div class="dashboard-container">
  <h2 class="dashboard-title">
    <i class="bi bi-folder2-open text-warning"></i> Tableau de Bord des Projets
  </h2>

  <!-- Statistiques globales -->
  <div class="stats-section">
    <h4 class="section-title">
      <i class="bi bi-bar-chart-line"></i> Statistiques
    </h4>

    <div class="stats-cards">
      <div class="stat-card total">
        <h5>Total Projets</h5>
        <p>{{ stats?.totalProjects || 0 }}</p>
      </div>
      <div class="stat-card completed">
        <h5>Projets Termin√©s</h5>
        <p>{{ stats?.completedProjects || 0 }}</p>
      </div>
      <div class="stat-card average">
        <h5>Moyenne des Scores</h5>
        <p>
          {{
            stats?.avgScore != null ? (stats.avgScore | number : "1.1-2") : 0
          }}
        </p>
      </div>
    </div>
  </div>

  <!-- Liste des projets -->
  <div class="projects-section mt-5">
    <h4 class="section-title">
      <i class="bi bi-folder"></i> Liste des Projets
    </h4>

    <div class="project-controls">
      <select [(ngModel)]="selectedProjectId" class="form-select">
        <option value="">-- S√©lectionner un projet --</option>
        <option *ngFor="let p of projets" [value]="p.id">
          {{ p.projectTitle || "(Sans titre)" }}
        </option>
      </select>

      <button class="btn btn-primary" (click)="showSimilar()">
        üîç Voir les Projets Similaires
      </button>
    </div>

    <!-- R√©sultats des projets similaires -->
    <div *ngIf="similarProjects.length > 0" class="similar-section mt-4">
      <h5>
        <i class="bi bi-diagram-2 text-info"></i>
        Projets Similaires √†
        <strong>{{ selectedProjectId }}</strong>
      </h5>

      <table class="table table-hover shadow-sm">
        <thead>
          <tr>
            <th>Titre</th>
            <th>R√©sum√©</th>
            <th>Type</th>
            <th>Date Livraison</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let sp of similarProjects">
            <td>
              <i class="bi bi-folder-fill text-warning"></i>
              {{ sp.projectTitle }}
            </td>
            <td>{{ sp.projectSummary }}</td>
            <td>
              <span
                class="badge"
                [ngClass]="{
                  'bg-success': sp.type === 'CompletedProject',
                  'bg-warning': sp.type === 'OngoingProject'
                }"
              >
                {{ sp.type }}
              </span>
            </td>
            <td>{{ sp.deliveryDate | date : "dd/MM/yyyy" }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div
      *ngIf="similarProjects.length === 0 && selectedProjectId"
      class="no-data"
    >
      <p><i class="bi bi-info-circle"></i> Aucun projet similaire trouv√©.</p>
    </div>
  </div>
</div>
